## Probanod. Leamos la base
credit <- read.csv("credit.csv")

## Observemos la base
str(credit)

## ------------------------------------------------------------------------
credit$default <- factor(credit$default)

## ------------------------------------------------------------------------
summary(credit$amount)

## ------------------------------------------------------------------------
summary(credit$months_loan_duration)

## ------------------------------------------------------------------------
table(credit$checking_balance)

## ------------------------------------------------------------------------
table(credit$savings_balance)

## ------------------------------------------------------------------------
set.seed(123)

## ------------------------------------------------------------------------
train_sample <- sample(1000, 900)

## ------------------------------------------------------------------------
str(train_sample)

## ------------------------------------------------------------------------
credit_train <- credit[train_sample, ]
credit_test <- credit[-train_sample, ]

## ------------------------------------------------------------------------
str(credit_train)

## ------------------------------------------------------------------------
str(credit_test)

## ------------------------------------------------------------------------
prop.table(table(credit_train$default))

## ------------------------------------------------------------------------
prop.table(table(credit_test$default))

## ------------------------------------------------------------------------
prop.table(table(credit$default))

## ------------------------------------------------------------------------
library(C50)

## ------------------------------------------------------------------------
credit_model <- C5.0(credit_train[-21], credit_train$default)

## ------------------------------------------------------------------------
credit_model

## ------------------------------------------------------------------------
summary(credit_model)

## ------------------------------------------------------------------------
credit_pred <- predict(credit_model, credit_test)

## ------------------------------------------------------------------------
library(gmodels)

## ------------------------------------------------------------------------
CrossTable(credit_test$default, credit_pred, prop.chisq=FALSE, prop.c=FALSE, prop.r=FALSE, dnn=c("default real", 'default pronosticado'))

